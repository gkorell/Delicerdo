{# empty Twig template #}

{% extends 'TodoCerdoTodoCerdoBundle::layout.html.twig' %}

{% block stylesheets %}
{{ parent() }}

    {% stylesheets 'bundles/todocerdotodocerdo/css/detalle.css' filter='cssrewrite' %}
        <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}

{% endblock %}

{% block body %}
<h2>Detalle de su compra</h2>
<div id="tablaDetalle">
<table>
    <tr>
        <th></th>
        <th>Producto</th>
        <th>Precio Unitario</th>
        <th>Cantidad</th>
        <th>Subtotal</th>
        <th>Borrar</th>
    </tr>
{% set cant = 0 %}    

{% for detalle in carrito %}
    <tr>
        <td><img class="img" src="{{asset(detalle.producto.getWebPath())}}"></td>
        <td>{{detalle.producto.getNombre()}}</td>
        <td>${{detalle.producto.calcularPrecio()}}</td>
        <td>{{detalle.cantidad}}</td>
        <td>${{detalle.calcularSubtotal}}</td>
        <td>
            {% image '@TodoCerdoTodoCerdoBundle/Resources/public/images/delete.png' %}
              <img class="delete" id="{{cant}}" name="{{detalle.calcularSubtotal}}" src="{{ asset_url }}"/>
            {% endimage %}
        </td>
    </tr>
    {% set cant=cant+1 %}
{%endfor%}
    
</table>

<div class="leyenda"><p>(*) NO INCLUYE GASTOS DE ENV√çO</p></div><div class="total"><p>(*)Total: ${{precioTotal}}</p></div>
</div>
<div class="botones">
    <a href="{{ path('TodoCerdoTodoCerdoBundle_productos')}}"><button>Continuar Comprando</button></a>
    <a href="{{ path('TodoCerdoTodoCerdoBundle_darUbicacion')}}"><button>Finalizar Pedido</button></a>
</div>
{% endblock %}

{% block sidebar %}

{% endblock %}

{% block javascripts %}
{{ parent() }}

<script type="text/javascript">
    
    $(document).ready(function(){
    
        $('.delete').live('click',function(){
            var indice = $(this).attr("id");
            var sub = $(this).attr("name");
            var url = "{{ path('TodoCerdoTodoCerdoBundle_eliminarDetalle') }}";
            
            $.ajax({
                type:"GET",
                url:url,
                data:{elemento: indice, subtotal:sub },
                success: function(data){
                    $('#tablaDetalle').html(data);
                }
            });
        
        });
    
    
    });
</script>
    
{% endblock %}